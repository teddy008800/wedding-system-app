<div class="register-page">
  <div class="register-shell">
    <div class="register-header">
      <div class="register-kicker">Wedding Card Registration</div>
      <h1 class="register-title">Register Your Wedding</h1>
      <p class="register-subtitle">Isi maklumat pasangan untuk cipta kad jemputan digital.</p>
    </div>

    <div class="register-card">
      <form class="register-form" (ngSubmit)="submitRegistration()">
        <div class="grid">
          <div>
            <label class="label">Groom Name</label>
            <input class="input" [(ngModel)]="form.groom" name="groom" required />
            <div class="register-error" *ngIf="showFieldError('groom')">Required.</div>
          </div>
          <div>
            <label class="label">Bride Name</label>
            <input class="input" [(ngModel)]="form.bride" name="bride" required />
            <div class="register-error" *ngIf="showFieldError('bride')">Required.</div>
          </div>
        </div>
        <div class="register-slug" *ngIf="slugPreview">
          Slug preview: <strong>{{ slugPreview }}</strong>
        </div>
        <div class="register-error" *ngIf="slugError">{{ slugError }}</div>

        <div class="grid">
          <div>
            <label class="label">Wedding Date</label>
            <input class="input" type="date" [(ngModel)]="form.weddingDate" name="weddingDate" required />
            <div class="register-error" *ngIf="showFieldError('weddingDate')">Required.</div>
          </div>
          <div>
            <label class="label">Venue</label>
            <input class="input" [(ngModel)]="form.venue" name="venue" required />
            <div class="register-error" *ngIf="showFieldError('venue')">Required.</div>
          </div>
        </div>

        <div class="grid">
          <div>
            <label class="label">Wedding #Tag <span class="optional">(optional)</span></label>
            <input class="input" [(ngModel)]="form.weddingTag" name="weddingTag" />
          </div>
          <div>
            <label class="label">Phone Number</label>
            <input class="input" [(ngModel)]="form.phoneNumber" name="phoneNumber" required />
            <div class="register-error" *ngIf="showFieldError('phoneNumber')">Required.</div>
          </div>
        </div>

        <div class="grid">
          <div>
            <label class="label">Google Map URL</label>
            <input class="input" [(ngModel)]="form.googleMapUrl" name="googleMapUrl" required />
            <div class="register-error" *ngIf="showFieldError('googleMapUrl')">Required.</div>
          </div>
          <div>
            <label class="label">Dress Code <span class="optional">(optional)</span></label>
            <input class="input" [(ngModel)]="form.dressCode" name="dressCode" />
          </div>
        </div>

        <div class="grid">
          <div>
            <label class="label">Wedding Tentative</label>
            <div class="tentative-list">
              <div class="tentative-row" *ngFor="let item of tentativeItems; let i = index">
                <div class="tentative-time">
                  <input class="input" type="time" [(ngModel)]="item.time" name="time{{ i }}" />
                </div>
                <input class="input" type="text" placeholder="Activity" [(ngModel)]="item.title" name="title{{ i }}" />
                <button class="btn-outline small-btn" type="button" (click)="removeTentativeRow(i)">Remove</button>
              </div>
              <button class="btn-outline small-btn" type="button" (click)="addTentativeRow()">Add Row</button>
            </div>
          </div>
          <div>
            <label class="label">Nasheed</label>
            <select class="input" [(ngModel)]="form.nasheedId" name="nasheedId" required>
              <option value="">Select nasheed</option>
              <option *ngFor="let item of nasheedOptions" [value]="item.id">{{ item.title }}</option>
            </select>
            <div class="register-error" *ngIf="showFieldError('nasheedId')">Required.</div>
          </div>
        </div>

        <button class="btn-primary" type="submit" [disabled]="loading">
          {{ loading ? 'Submitting...' : 'Register Wedding' }}
        </button>
        <div class="register-result" *ngIf="result">{{ result }}</div>
      </form>
    </div>
  </div>
</div>

<div
  class="fixed inset-0 z-50 grid place-items-center bg-slate-900/40 backdrop-blur-sm modal-fade"
  *ngIf="confirmModal.open"
>
  <div class="w-[min(92vw,420px)] rounded-2xl border border-rose-200/60 bg-white p-6 shadow-[0_24px_40px_rgba(15,23,42,0.25)] modal-pop">
    <div class="text-lg font-semibold text-slate-900">Confirm Submission</div>
    <p class="mt-2 text-sm text-slate-600">{{ confirmModal.message }}</p>
    <div class="mt-5 flex justify-end gap-2">
      <button class="btn-outline text-slate-900" type="button" (click)="closeConfirm()">Cancel</button>
      <button class="btn-primary" type="button" (click)="confirmAction()">Confirm</button>
    </div>
  </div>
</div>
